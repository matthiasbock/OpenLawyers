<html>
<head>
<title>Wiedervorlagen</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<link rel="stylesheet" type="text/css" href="/skin/styles.css">
<script src="scripts.js" type="text/javascript"></script>
<script language="Javascript">

week = 604800000;

function init()
{
	initlist();
	nextDate(0);
	document.which.tag.focus();
	POSTErhalten();
}

// ursprüngliche POSTs müssen durch clientseitige Unterstützung erhalten werden

function POSTErhalten()
{
   // Diese Aktionen sind nur sinnvoll und erforderlich, falls tatäschlich Änderungen vorgenommen wurden,
   // also zumindest der Aktualisieren-Button gedrückt wurde ...
   
   sPOSTs="_AKTUALISIERE_";
   if (sPOSTs=="Aktualisieren")
   {     
        oFormElement=document.which;
        oFormElement.tag.value="_TAG_";
        oFormElement.monat.value="_MONAT_";
        oFormElement.jahr.value="_JAHR_";
        
        for ($t=0;$t<oFormElement.bearbeiter.length;$t++)
        {
                if (oFormElement.bearbeiter[$t].value=="_BEARBEITER_")
                 { oFormElement.bearbeiter[$t].selected=1; } 
                 else { oFormElement.bearbeiter[$t].selected=0; }
        }
        
        for ($t=0;$t<oFormElement.wvtyp.length;$t++)
        {
                if (oFormElement.wvtyp[$t].value=="_WVTYP_")
                 { oFormElement.wvtyp[$t].selected=1; } 
                 else { oFormElement.wvtyp[$t].selected=0; }
        }
  }
}


function nextDate(t)
{
	Datum = new Date();
	newDatum = new Date(Datum.getTime()+(t*week));
	document.which.tag.value=newDatum.getDate();
	document.which.monat.value=newDatum.getMonth()+1;
	document.which.jahr.value=newDatum.getFullYear();
}

</script>
</head>
<body onload="init()">
<table class="mainframe" cellspacing=0 width="100%" height="100%">
<tr><td align="center" valign="middle">


<form action="olclient.php" method="POST" name="which">

<table class="dialog">

<tr><td colspan="4" style="font-size:9px;text-align:right;"><a href="javascript:print()">Drucken</a></td></tr>

<tr><td colspan="4" class="hauptpunkt">Wiedervorlagen anzeigen nach</td></tr>
<tr><td>Bis (Datum)</td>
	<td>Für (Bearbeiter)</td>
	<td style="width:100%;">Wiedervorlagentyp</td>
	
	 </tr>

<tr><td nowrap>
		<input type="text" style="text-align:right;" class="textfield" size="2" maxlength="2" tabindex="1" name="tag">.
		<input type="text" style="text-align:right;" class="textfield" size="2" maxlength="2" tabindex="2" name="monat">.
		<input type="text" style="text-align:right;" class="textfield" size="4" maxlength="4" tabindex="3" name="jahr"></td>
	<td><select class="dropdown" tabindex="5" name="bearbeiter" size="1">
		
			<option _selected_ value="_id_">_user_</option>
		
		</select></td>
	
	<td><select style="width:100%;" class="dropdown" tabindex="6" name="wvtyp" size="1">
		
			<option value="_wvtypid_">_wvtyp_</option>
		
		</select></td>	
	
	<td style="text-align:right;"><input style="width:10em;" type="submit" class="button" tabindex="7" name="aktualisiere" value="Aktualisieren"></td></tr>

<tr><td><select style="width:100%;" class="dropdown" tabindex="4" size="1">
		<option onclick="nextDate(0)">Für heute</option>
		<option onclick="nextDate(2)">in 2 Wochen</option>
		<option onclick="nextDate(4)">in 4 Wochen</option>
		<option onclick="nextDate(6)">in 6 Wochen</option>
		<option onclick="nextDate(12)">in 12 Wochen</option>
		</select></td></tr>

<tr><td colspan="4" class="hauptpunkt">_whichWV_ bis _wvdatum_ für _wvuser_</td></tr>
<tr><td colspan="3">

		<table width="100%" class="tablelist" id="sortable" cellspacing=0 cellpadding=2>
			<tr class="tablelistheader">
			                                <td>Datum <span class="clickable" onclick="sortTable(this,'Date')">&uarr;</span><span class="clickable" onclick="sortTable(this,'Date','DESC')">&darr;</span></td>
			                                <td>Kurzrubrum <span class="clickable" onclick="sortTable(this)">&uarr;</span><span class="clickable" onclick="sortTable(this,'DESC')">&darr;</span></td>
			                                <td>Grund <span class="clickable" onclick="sortTable(this)">&uarr;</span><span class="clickable" onclick="sortTable(this,'DESC')">&darr;</span></td>
			                                <td>Typ <span class="clickable" onclick="sortTable(this)">&uarr;</span><span class="clickable" onclick="sortTable(this,'DESC')">&darr;</span></td>
			                                <td>AZ <span class="clickable" onclick="sortTable(this,'AZ')">&uarr;</span><span class="clickable" onclick="sortTable(this,'AZ','DESC')">&darr;</span></td>
                                                        <td>Bearbeiter <span class="clickable" onclick="sortTable(this)">&uarr;</span><span class="clickable" onclick="sortTable(this,'DESC')">&darr;</span></td>
                        </tr>
			             
			<tr class="tablelist" id="_nr_" onclick="colorize(_nr_);actButtons('oeffnen');"><td>_datum_</td><td nowrap>_krubrum_</td><td>_grund_</td><td>_typ_</td><td>_az_</td><td nowarp>_bearbeiter_</td></tr>

		</table>
		
		<input type="hidden" name="zeile" value="">

	
	</td>
	<td style="text-align:right;vertical-align:top;"><input style="width:10em;" type="submit" class="button" tabindex="7" name="oeffnen" value="Akte öffnen" disabled></td></tr>
<input type="hidden" name="function" value="3">

</table>
</form>

</td></tr></table>

<!-- Eine Error-MSG Box -->

<span id="error" style="width:100%;height:100%;position:absolute;top:0px;left:0px;display:_display_;cursor:wait;">
<span style="position:absolute;top:50%;left:50%;cursor:default;">
	<div style="position:absolute;top:-60px;left:-135px;width:300px;height:150px;">
		<img style="filter:Alpha(opacity=40);-moz-opacity:0.4;opacity:0.4;" src="/skin/shadow.gif">
	</div>
	<div class="errorheadline" style="position:absolute;top:-75px;left:-150px;width:300px;height:20px;">
		Wichtiger Hinweis !
	</div>
	<div class="errorbody" style="width:300px;height:100px;position:absolute;top:-55px;left:-150px;">
		<table width="100%" height="100%"><tr><td style="width:100px;"><img src="/skin/error.gif"></td><td class="errorbody" style="border-style:none;">_error_</td></tr></table>
	</div>
	<div class="errorbody" style="width:300px;height:30px;position:absolute;top:45px;left:-150px;border-bottom-style:solid;">
		<input type="button" class="button" value="OKAY" onclick="Javascript:document.getElementById('error').style.display='none';document.which.tag.focus();">
	</div>
</span>
</span>

</body>
</html>
